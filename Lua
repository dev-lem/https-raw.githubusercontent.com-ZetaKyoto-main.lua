-- ZETA KYOTO v0.6 (FINAL NO-BS VERSION)
-- Loading screen + restored v0.4 combat + working ping check

--=== LOADING SCREEN ===--
local Players = game:GetService("Players")
local PlayerGui = Players.LocalPlayer:WaitForChild("PlayerGui")

local LoadingGui = Instance.new("ScreenGui")
LoadingGui.Name = "ZetaLoader"
LoadingGui.IgnoreGuiInset = true

local BlackBg = Instance.new("Frame")
BlackBg.Size = UDim2.new(1, 0, 1, 0)
BlackBg.BackgroundColor3 = Color3.new(0, 0, 0)
BlackBg.BackgroundTransparency = 0.3
BlackBg.ZIndex = 999
BlackBg.Parent = LoadingGui

local LoadText = Instance.new("TextLabel")
LoadText.Text = "PLEASE WAIT 5 SECONDS"
LoadText.Font = Enum.Font.SourceSansBold
LoadText.TextSize = 24
LoadText.TextColor3 = Color3.new(1, 1, 1)
LoadText.Size = UDim2.new(1, 0, 1, 0)
LoadText.BackgroundTransparency = 1
LoadText.ZIndex = 1000
LoadText.Parent = BlackBg

LoadingGui.Parent = PlayerGui
task.wait(5)
LoadingGui:Destroy()

--=== MAIN UI ===--
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ZetaKyoto_v6"
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 200, 0, 250)
MainFrame.Position = UDim2.new(0.5, -100, 0.5, -125)
MainFrame.BackgroundColor3 = Color3.fromHex("#181820")
MainFrame.BackgroundTransparency = 0.4
MainFrame.Active = true
MainFrame.Draggable = true

-- Top Bar
local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0.12, 0)
TopBar.Position = UDim2.new(0, 0, 0, 0)
TopBar.BackgroundColor3 = Color3.fromHex("#4A1D96")
TopBar.BackgroundTransparency = 0.4
TopBar.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Text = "ZETA KYOTO v0.6"
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18
Title.TextColor3 = Color3.new(1,1,1)
Title.Size = UDim2.new(1, 0, 1, 0)
Title.BackgroundTransparency = 1
Title.Parent = TopBar

-- Main Buttons
local PingButton = Instance.new("TextButton")
PingButton.Text = "CHECK PING & START"
PingButton.Font = Enum.Font.SourceSansBold
PingButton.TextSize = 14
PingButton.Size = UDim2.new(0.85, 0, 0.18, 0)
PingButton.Position = UDim2.new(0.075, 0, 0.3, 0)
PingButton.BackgroundColor3 = Color3.fromHex("#7E3AF2")
PingButton.BackgroundTransparency = 0.4
PingButton.TextColor3 = Color3.new(1,1,1)
PingButton.Parent = MainFrame

local KyotoButton = Instance.new("TextButton")
KyotoButton.Text = "AUTO KYOTO"
KyotoButton.Font = Enum.Font.SourceSansBold
KyotoButton.TextSize = 16
KyotoButton.Size = UDim2.new(0.85, 0, 0.18, 0)
KyotoButton.Position = UDim2.new(0.075, 0, 0.55, 0)
KyotoButton.BackgroundColor3 = Color3.fromHex("#7E3AF2")
KyotoButton.BackgroundTransparency = 0.4
KyotoButton.TextColor3 = Color3.new(1,1,1)
KyotoButton.Visible = false
KyotoButton.Parent = MainFrame

-- Settings Button
local SettingsBtn = Instance.new("TextButton")
SettingsBtn.Text = "⚙️"
SettingsBtn.Size = UDim2.new(0, 30, 0, 30)
SettingsBtn.Position = UDim2.new(1, -35, 0, 5)
SettingsBtn.BackgroundColor3 = Color3.fromHex("#4A1D96")
SettingsBtn.BackgroundTransparency = 0.4
SettingsBtn.TextSize = 18
SettingsBtn.TextColor3 = Color3.new(1,1,1)
SettingsBtn.Parent = MainFrame

-- Settings Panel
local SettingsPanel = Instance.new("Frame")
SettingsPanel.Size = UDim2.new(0, 190, 0, 180)
SettingsPanel.Position = UDim2.new(1, 5, 0, 40)
SettingsPanel.BackgroundColor3 = Color3.fromHex("#181820")
SettingsPanel.BackgroundTransparency = 0.25
SettingsPanel.Visible = false
SettingsPanel.Parent = MainFrame

-- Settings Content
local OtherScriptsLabel = Instance.new("TextLabel")
OtherScriptsLabel.Text = "OTHER SCRIPTS"
OtherScriptsLabel.Font = Enum.Font.SourceSansBold
OtherScriptsLabel.TextSize = 14
OtherScriptsLabel.TextColor3 = Color3.new(1,1,1)
OtherScriptsLabel.Size = UDim2.new(1, -20, 0, 25)
OtherScriptsLabel.Position = UDim2.new(0, 15, 0, 15)
OtherScriptsLabel.BackgroundTransparency = 1
OtherScriptsLabel.Parent = SettingsPanel

local AutoBlockBtn = Instance.new("TextButton")
AutoBlockBtn.Text = "AUTO BLOCK"
AutoBlockBtn.Font = Enum.Font.SourceSansBold
AutoBlockBtn.TextSize = 12
AutoBlockBtn.Size = UDim2.new(1, -30, 0, 30)
AutoBlockBtn.Position = UDim2.new(0, 15, 0, 45)
AutoBlockBtn.BackgroundColor3 = Color3.fromHex("#7E3AF2")
AutoBlockBtn.BackgroundTransparency = 0.4
AutoBlockBtn.TextColor3 = Color3.new(1,1,1)
AutoBlockBtn.Parent = SettingsPanel

local Signature = Instance.new("TextLabel")
Signature.Text = "Made by K - Z"
Signature.Font = Enum.Font.SourceSans
Signature.TextSize = 10
Signature.TextColor3 = Color3.fromHex("#AAAAAA")
Signature.Size = UDim2.new(1, 0, 0, 20)
Signature.Position = UDim2.new(0, 0, 0, 150)
Signature.BackgroundTransparency = 1
Signature.TextXAlignment = Enum.TextXAlignment.Center
Signature.Parent = SettingsPanel

--=== CORE FUNCTIONS ===--
local function showNotif(text)
    game.StarterGui:SetCore("SendNotification", {
        Title = "KYOTO", 
        Text = text, 
        Duration = 3
    })
end

local function calculateWaitTime(ping)
    local base = 1.45
    if ping <= 50 then return base * 0.65
    elseif ping <= 100 then return base * 0.75
    elseif ping <= 150 then return base * 0.85
    elseif ping <= 200 then return base * 0.95
    elseif ping <= 250 then return base * 1.05
    else return base * 1.15 end
end

local function teleportForward()
    local root = Player.Character:WaitForChild("HumanoidRootPart")
    root.CFrame = CFrame.new(root.Position + root.CFrame.LookVector * 18.42)
end

local function pressKey1()
    local tool = Player.Backpack:FindFirstChild("Flowing Water")
    if tool then 
        tool.Parent = Player.Character
        task.wait(1)
        tool.Parent = Player.Backpack
    end
end

local function pressKey2()
    local tool = Player.Backpack:FindFirstChild("Lethal Whirlwind Stream")
    if tool then 
        tool.Parent = Player.Character
        task.wait(1)
        tool.Parent = Player.Backpack
    end
end

--=== FUNCTIONALITY ===--
SettingsBtn.MouseButton1Click:Connect(function()
    SettingsPanel.Visible = not SettingsPanel.Visible
end)

AutoBlockBtn.MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Cyborg883/TSB/main/CombatGui"))()
end)

local debounce = false
PingButton.MouseButton1Click:Connect(function()
    if debounce then return end
    debounce = true
    
    local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
    local waitTime = calculateWaitTime(ping)
    KyotoButton.Visible = true
    showNotif("Ping: "..math.floor(ping).."ms | Wait: "..waitTime.."s")
    
    debounce = false
end)

KyotoButton.MouseButton1Click:Connect(function()
    if debounce then return end
    debounce = true
    
    local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
    local waitTime = calculateWaitTime(ping)
    
    pressKey1()
    task.wait(waitTime)
    teleportForward()
    pressKey2()
    
    showNotif("Combo executed!")
    debounce = false
end)

--=== FINALIZE ===--
MainFrame.Parent = ScreenGui
ScreenGui.Parent = PlayerGui
